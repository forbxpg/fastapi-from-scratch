# Generating secret hash

Why do I use the `hmac` algorithm when creating `ClientSecret`.\
I could use `sha256` itself but used `hmac`.

Here the idea is when the hash is generated by `sha256` the algorithm generates hash only once\
and the hacker can just append additional info at the end of hash and can access the some permissions.\
It is called [Length Extension Attack](https://ru.wikipedia.org/wiki/Атака_удлинением_сообщения).
Here the performance of `hmac` comes: `hmac` has **inner** and **outer**\
hashing methods. The **inner** just takes `message = client_id + client_username` hashes it like:\


1. `inner = sha256_func((secret_key XOR ipod) + message)  # first hashing`

2. `outer = sha256_func((secret_key XOR ipad) + inner)    # second hashing`


So, by this method hacker won`t be able to provide the [LEA](https://ru.wikipedia.org/wiki/Атака_удлинением_сообщения) and go cry:)

 
